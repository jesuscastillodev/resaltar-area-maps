const process = { env: {} };
process.env.GOOGLE_MAPS_API_KEY = "AIzaSyBJfigiuW-6OBXiHbl_wxJFWsmWfhb07uA";
function textToCordinates(MultiGeometryCoordinates) {
  var finalData = [];
  myArray = MultiGeometryCoordinates.split(" ");
  myArray.forEach(function (item, i) {
    let coordenadas = item.split(",");
    finalData.push({
      lng: parseFloat(coordenadas[0]),
      lat: parseFloat(coordenadas[1]),
    });
  });
  return finalData;
}

var map;
var comunas = {
  value: "",
  setElementList: (comuna) => {
    comunas.value += `<li class="list-zones__row"><label><input type="checkbox" class="checkbox__input" ${
      comuna.today ? "checked='checked'" : ""
    } 
          value="${comuna.id}" id="comuna_${comuna.id}"><span class="">${
      comuna.name
    }</span></label></li>`;
  },
  clearHtml: () => {
    comunas.value = "";
  },
};
const setPoligonToMap = (comuna) => {
  const Coordenadas = textToCordinates(comuna.coordenadas);
  // crear area con las coordenadas indicadas por comuna
  let Polygon = new google.maps.Polygon({
    paths: Coordenadas,
    strokeColor: "#0037FF",
    strokeOpacity: 0.8,
    strokeWeight: 3,
    fillColor: "#0037FF",
    fillOpacity: 0.35,
  });
  // insertar area al mapa
  Polygon.setMap(map);
};
initMap = () => {
  // inicializar mapa
  map = new google.maps.Map(document.getElementById("map"), {
    center: { lat: -33.4863885, lng: -70.6688092 }, // coordenadas del mapa
    zoom: 10, // zoom aplicado al mapa
  });
  comunas.clearHtml();
  for (let comuna of coordenadas.comunas) {
    comunas.setElementList(comuna);
    if (comuna.today) setPoligonToMap(comuna);
  }
  // insertar html listado de comunas
  document.getElementById("list-zones__list").innerHTML = comunas.value;
};
// cambios en las comunas seleccionadas
document.getElementById("list-zones__list").addEventListener("click", () => {
  if (event.target.classList.contains("checkbox__input")) {
    coordenadas.comunas = coordenadas.comunas.map((comuna) => {
      if (comuna.id == event.target.defaultValue) {
        comuna.today = event.target.checked;
      }
      return comuna;
    });
    initMap();
  }
});
// listado de comunas con sus coordenadas obtenido desde https://gadm.org/download_country.html
var coordenadas = {
  comunas: [
    {
      id: 294,
      name: "LA REINA",
      region_id: 14,
      today: true,
      coordenadas:
        "-70.5844,-33.4318 -70.5391,-33.4289 -70.5379,-33.4334 -70.523,-33.4316 -70.516,-33.4351 -70.5095,-33.4357 -70.5034,-33.4391 -70.4962,-33.4467 -70.4961,-33.4508 -70.4897,-33.4557 -70.4869,-33.4618 -70.5295,-33.4591 -70.5314,-33.4654 -70.5404,-33.463 -70.5626,-33.4624 -70.5724,-33.459 -70.5708,-33.4535 -70.5736,-33.4379 -70.5844,-33.4318",
    },
    {
      id: 295,
      name: "LAS CONDES",
      region_id: 14,
      today: true,
      coordenadas:
        "-70.4344,-33.481 -70.4398,-33.4866 -70.4521,-33.4825 -70.4611,-33.4761 -70.4736,-33.4747 -70.4865,-33.4632 -70.4897,-33.4557 -70.4961,-33.4508 -70.4962,-33.4467 -70.5082,-33.4361 -70.516,-33.4351 -70.523,-33.4316 -70.5379,-33.4334 -70.5391,-33.4289 -70.5844,-33.4318 -70.6017,-33.4178 -70.6079,-33.4155 -70.6065,-33.4107 -70.6059,-33.4093 -70.5866,-33.4042 -70.5434,-33.3881 -70.5339,-33.3838 -70.5249,-33.3759 -70.5159,-33.372 -70.4957,-33.367 -70.4928,-33.3646 -70.4845,-33.3643 -70.4785,-33.3663 -70.4755,-33.3688 -70.4814,-33.3716 -70.4837,-33.3778 -70.4796,-33.3841 -70.4801,-33.3866 -70.4772,-33.3917 -70.4776,-33.3939 -70.4545,-33.3974 -70.4531,-33.4175 -70.4449,-33.4243 -70.4355,-33.4269 -70.434,-33.4288 -70.4309,-33.4387 -70.4322,-33.4447 -70.4289,-33.4496 -70.4281,-33.4582 -70.4296,-33.4622 -70.4354,-33.4681 -70.4334,-33.4734 -70.4344,-33.481",
    },
    {
      id: 296,
      name: "LO BARNECHEA",
      region_id: 14,
      today: true,
      coordenadas:
        "-70.5961,-33.3371 -70.5939,-33.335 -70.5941,-33.3318 -70.6,-33.3218 -70.6003,-33.3167 -70.6046,-33.3107 -70.6008,-33.3077 -70.5962,-33.3084 -70.591,-33.3031 -70.5929,-33.2996 -70.5745,-33.2894 -70.5707,-33.2786 -70.5728,-33.2759 -70.5719,-33.2736 -70.5733,-33.2719 -70.5736,-33.2655 -70.5696,-33.2619 -70.5675,-33.2565 -70.5601,-33.252 -70.562,-33.248 -70.558,-33.2416 -70.5463,-33.2411 -70.5434,-33.2388 -70.5364,-33.2401 -70.5242,-33.2389 -70.5152,-33.231 -70.5131,-33.2256 -70.5138,-33.2212 -70.5097,-33.2193 -70.5002,-33.2206 -70.4939,-33.2183 -70.4833,-33.218 -70.4732,-33.2196 -70.4702,-33.2166 -70.4701,-33.2097 -70.465,-33.2033 -70.4678,-33.2013 -70.4675,-33.1959 -70.4594,-33.1888 -70.4595,-33.1823 -70.4626,-33.1783 -70.4538,-33.172 -70.4546,-33.1681 -70.4445,-33.1592 -70.4449,-33.1566 -70.4415,-33.1473 -70.4367,-33.1443 -70.4339,-33.1376 -70.4277,-33.1298 -70.4218,-33.1279 -70.4179,-33.1238 -70.398,-33.1217 -70.3864,-33.1153 -70.3829,-33.1094 -70.3776,-33.1088 -70.3736,-33.1057 -70.3613,-33.107 -70.3454,-33.1035 -70.3433,-33.1019 -70.3428,-33.097 -70.3388,-33.0964 -70.3339,-33.098 -70.3295,-33.1021 -70.3212,-33.1031 -70.3182,-33.1096 -70.3105,-33.1085 -70.3037,-33.113 -70.2999,-33.1129 -70.2961,-33.1255 -70.2908,-33.1306 -70.2869,-33.132 -70.2729,-33.1311 -70.271,-33.1325 -70.2696,-33.1363 -70.2711,-33.1543 -70.2693,-33.1565 -70.2684,-33.1633 -70.2652,-33.1668 -70.2669,-33.1815 -70.2606,-33.1847 -70.243,-33.1874 -70.2398,-33.1922 -70.2402,-33.1967 -70.238,-33.2008 -70.2307,-33.2036 -70.2262,-33.2114 -70.2179,-33.2174 -70.2176,-33.223 -70.2228,-33.2279 -70.2231,-33.2317 -70.2208,-33.2374 -70.2178,-33.2385 -70.2143,-33.2371 -70.2167,-33.2389 -70.2164,-33.2407 -70.2082,-33.2501 -70.2105,-33.2593 -70.2045,-33.2627 -70.1984,-33.2715 -70.2005,-33.2786 -70.1993,-33.2903 -70.188,-33.305 -70.1821,-33.3221 -70.1821,-33.3381 -70.1759,-33.3465 -70.1802,-33.3507 -70.1773,-33.3565 -70.1806,-33.3592 -70.1816,-33.3625 -70.1869,-33.3631 -70.1918,-33.3666 -70.1944,-33.3725 -70.1934,-33.3767 -70.1979,-33.3801 -70.2032,-33.3916 -70.2133,-33.3958 -70.2178,-33.4006 -70.217,-33.407 -70.219,-33.4123 -70.2358,-33.4236 -70.2383,-33.4294 -70.2412,-33.4309 -70.2442,-33.4358 -70.2541,-33.4394 -70.2576,-33.4437 -70.2668,-33.4454 -70.2816,-33.4554 -70.2853,-33.4524 -70.2923,-33.451 -70.2984,-33.4521 -70.2992,-33.4583 -70.3047,-33.4645 -70.315,-33.4666 -70.3208,-33.4724 -70.3345,-33.4767 -70.3407,-33.4846 -70.3514,-33.4916 -70.3538,-33.4864 -70.3611,-33.4872 -70.3752,-33.4827 -70.3885,-33.4867 -70.3937,-33.4907 -70.403,-33.4895 -70.4191,-33.4819 -70.4285,-33.4843 -70.4296,-33.482 -70.4344,-33.481 -70.4334,-33.4734 -70.4354,-33.4681 -70.4296,-33.4622 -70.4281,-33.4582 -70.4289,-33.4496 -70.4322,-33.4447 -70.4309,-33.4387 -70.434,-33.4288 -70.4355,-33.4269 -70.4449,-33.4243 -70.4531,-33.4175 -70.4545,-33.3974 -70.4776,-33.3939 -70.4772,-33.3917 -70.4801,-33.3866 -70.4796,-33.3841 -70.4837,-33.3778 -70.4814,-33.3716 -70.4755,-33.3688 -70.4765,-33.3674 -70.4842,-33.3643 -70.4913,-33.3645 -70.4957,-33.367 -70.5176,-33.3727 -70.5195,-33.3704 -70.5237,-33.3695 -70.5406,-33.3703 -70.5469,-33.3648 -70.5503,-33.3593 -70.5603,-33.3585 -70.5676,-33.3555 -70.5729,-33.3558 -70.5761,-33.3526 -70.5831,-33.3507 -70.5889,-33.3458 -70.5914,-33.3392 -70.5961,-33.3371",
    },
    {
      id: 299,
      name: "MACUL",
      region_id: 14,
      today: true,
      coordenadas:
        "-70.59,-33.5102 -70.6137,-33.5084 -70.623,-33.4749 -70.5965,-33.4735 -70.5875,-33.4744 -70.5768,-33.4702 -70.5808,-33.49 -70.5873,-33.5003 -70.59,-33.5102",
    },
    {
      id: 300,
      name: "MAIPU",
      region_id: 14,
      today: true,
      coordenadas:
        "-70.7674,-33.572 -70.7856,-33.5674 -70.8046,-33.5509 -70.816,-33.5437 -70.8056,-33.5359 -70.8045,-33.5308 -70.8078,-33.5283 -70.8137,-33.5315 -70.8186,-33.5381 -70.8431,-33.5342 -70.852,-33.5378 -70.8589,-33.5305 -70.8724,-33.5327 -70.8866,-33.528 -70.8924,-33.5204 -70.8975,-33.5184 -70.9049,-33.5114 -70.9105,-33.5094 -70.921,-33.5115 -70.9231,-33.5092 -70.9281,-33.5083 -70.9301,-33.5058 -70.9298,-33.5009 -70.9262,-33.4967 -70.9235,-33.4895 -70.9152,-33.4875 -70.9117,-33.4842 -70.895,-33.4785 -70.8781,-33.4766 -70.8602,-33.4799 -70.8495,-33.4799 -70.8411,-33.4671 -70.8292,-33.4656 -70.8268,-33.467 -70.817,-33.4667 -70.8064,-33.461 -70.8047,-33.4631 -70.7966,-33.4631 -70.7967,-33.4604 -70.7786,-33.4631 -70.7772,-33.4629 -70.7758,-33.4582 -70.7649,-33.4593 -70.7635,-33.4638 -70.7379,-33.4685 -70.737,-33.4715 -70.7338,-33.4696 -70.7228,-33.473 -70.7247,-33.4827 -70.7315,-33.4828 -70.7315,-33.4949 -70.7401,-33.5101 -70.7233,-33.51 -70.7185,-33.5141 -70.7674,-33.572",
    },
  ],
};

// recomendado colocar directamente el resultado en el campo de coordenadas para mejorar el rendimiento ejem: coordenadas: [[lng:-70.6954,lat:-33.5024],[lng:-70.6861,lat:-33.4785]...]
